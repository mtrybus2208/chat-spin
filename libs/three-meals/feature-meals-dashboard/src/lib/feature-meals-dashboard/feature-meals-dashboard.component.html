<div class="dashboard">
  <img
    src="/assets/cloud1.png"
    alt=""
    class="dashboard__cloud dashboard__cloud--1"
  />
  <img
    src="/assets/cloud2.png"
    alt=""
    class="dashboard__cloud dashboard__cloud--2"
  />
  <div class="dashboard__card">
    <div class="dashboard__header">
      <h2 class="dashboard__header-title">Welcome to 3 Meals</h2>
      <p class="dashboard__header-subtitle">
        Lets‚Äôs set up your daily meal plan
      </p>
    </div>
    <div class="dashboard__counter">
      <p class="dashboard__counter-title">How many meals per day?</p>
      <lib-meals-counter (counterChange)="onCounterChange($event)" />
    </div>

    <form
      class="dashboard__form"
      [formGroup]="mealForm"
      (ngSubmit)="onSubmit()"
    >
      <p class="dashboard__form-title">
        What time do you eat?
        <span
          class="dashboard__form-hint-icon pi pi-info-circle"
          (click)="onHintToogle()"
        ></span>
      </p>
      @if(showMealsHintDescription()) {
      <div class="dashboard__form-hint-description">
        <p class="dashboard__form-hint-description-title">üçΩ Meals per day</p>

        <p>
          The number of meals you choose affects your energy levels, hunger
          control, and how easily you stick to your calorie goals. There is no
          single best option ‚Äî the right choice depends on your lifestyle, daily
          routine, and personal preferences.
        </p>
        <p-divider />
        <p class="dashboard__form-hint-description-title">‚è± Eating window</p>
        <p>
          Your eating window is the time range during the day when you consume
          all your meals, which can influence appetite, focus, and consistency.
          A shorter or longer window should be chosen based on what helps you
          feel energized, satisfied, and able to maintain your plan long term.
        </p>
      </div>
      }

      <div class="dashboard__form-items">
        @for(control of mealForm.controls.meals.controls; track control.value;
        let i = $index) {
        <div class="dashboard__form-item">
          <p-floatlabel variant="on">
            <p-datepicker
              fluid
              [formControl]="control"
              [timeOnly]="true"
              [stepMinute]="15"
              [inputId]="'calendar-timeonly-' + i"
            />

            <label
              [for]="'calendar-timeonly-' + i"
              [textContent]="'Meal ' + (i + 1) + ' time'"
            ></label>
          </p-floatlabel>
          @if (control.getError('timeInterval') && (control.dirty ||
          control.touched)) {
          <p-message
            severity="error"
            variant="simple"
            size="small"
            text="Meal time must be in 15-minute intervals."
          ></p-message>
          } @if (control.getError('duplicateTime') && (control.dirty ||
          control.touched)) {
          <p-message
            severity="error"
            variant="simple"
            size="small"
            text="This time is already selected."
          ></p-message>
          }
        </div>
        }
      </div>

      <p-button
        fluid
        label="Start Tracking"
        type="submit"
        [disabled]="mealForm.invalid"
      />
    </form>
  </div>
</div>
